

{% extends 'base.html' %}
{% load static %} 

{% block content %} 
<div id="colorlib-main">
    <section class="ftco-section ftco-no-pt ftco-no-pb">
        <div class="container">
            <div class="row d-flex">
                <div class="col-lg-8 px-md-5 py-5">
                    <div class="row pt-md-4">
                        <h3 class="mb-3">{{ post.title }}</h3>
                        <p>{{ post.content }}</p>
                        <p>
                            <img src="{{ post.image.url }}" alt="" class="img-fluid">
                        </p>
                        <div class="tag-widget post-tag-container mb-5 mt-5">
                            <div class="tagcloud">
                                {% for tag in all_tags %}
                                <a href="{% url 'tag-view' tag=tag.name %}" class="tag-cloud-link">{{tag.name}}</a>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div class="pt-5 mt-5">
                        <h3 class="mb-5 font-weight-bold">{{ post.comment_count }} comment{{post.comment_count|pluralize }}</h3>
                        {% if comments %}
                        {% for comment in comments %}
                        <ul class="comment-list">
                            <li class="comment">
                                <div class="comment-body">
                                    {% if comment.author %}
                                     <h3>{{ comment.author}}</h3>
                                    {% else %}
                                     <h3>anonymous</h3>
                                    {% endif %}
                                    <div class="meta">{{comment.created_date|date:'Y-m-d'}}</div>
                                    <p>{{comment.content}}</p>
                                    <!-- <p><a href="#" class="reply">Reply</a></p> -->
                                    <button class="reply-btn btn btn-sm btn-outline-primary" data-comment-id="{{ comment.id }}">Reply </button>
                                    
                                </div>
                            </li>
                        </ul>   
                        {% endfor %}
                        {% else %}
                            <strong class="text-secondary">No comments yet...</strong>
                        {% endif %}
                        <!-- END comment-list -->

                        <div class="comment-form-wrap pt-5">
                            <h3 class="mb-5">Leave a comment</h3>
                            <form method="post" action="{% url 'add-comment' post.pk %}">
                                {% csrf_token %}
                                <div class="form-group">
                                    <label>Message</label>
                                    <!-- تغییر نام فیلد به content -->
                                    <textarea 
                                        name="content" 
                                        cols="10" 
                                        rows="3" 
                                        class="form-control"
                                        required
                                    ></textarea>
                                </div>
                                
                                <!-- فیلد مخفی برای ریپلای -->
                                <input type="hidden" name="parent" value="">
                                
                                <!-- استفاده از دکمه سابمیت واقعی -->
                                <div class="mt-4">
                                    <button type="submit" class="btn btn-primary">
                                        New Comment
                                    </button>
                                </div>
                            </form>
                        </div> <!-- END-->
                    </div>  
                </div>
                {% include "dynamic.html" %}
            </div>
        </div>
    </section>
</div>
{% endblock content %}